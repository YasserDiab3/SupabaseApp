# الخطوات التالية — تطبيق HSE (Supabase)

## 1. التأكد من وجود مستخدم للتجربة

- في **Supabase Dashboard** → **Table Editor** → جدول **`users`**.
- **مستخدم جاهز (yasser.diab@icapp.com.eg / 654@123):**  
  تم إضافة ترحيل `20260221140000_seed_yasser_user.sql` الذي يضيف أو يحدّث هذا المستخدم. إما:
  - تشغيل الترحيلات: `npx supabase db push`  
  - أو نسخ محتوى الملف وتشغيله من **SQL Editor** في Supabase.
- إن أردت مستخدماً آخر أو كلمة مرور مختلفة: أضف صفاً في `users` مع **id** و **data** (يتضمن `email`, `name`, `role`) و **password_hash** = SHA-256 hex لكلمة المرور (64 حرفاً).

---

## 2. اختبار التطبيق محلياً

- افتح الواجهة من مجلد `SupabaseApp/Frontend` (مثلاً عبر Live Server أو بفتح `index.html`).
- جرّب:
  - **تسجيل الدخول** بالبريد وكلمة المرور للمستخدم المضاف.
  - **نسيت كلمة المرور؟** → إدخال البريد → التحقق من وصول البريد وتجربة الرابط.

---

## 3. نشر الواجهة على Netlify

- اتبع الملف **`SupabaseApp/Frontend/NETLIFY-DEPLOY.md`**:
  - ربط المستودع، Base directory = `SupabaseApp/Frontend`، Publish = `.`.
  - لا حاجة لـ Build command (موقع ثابت).
- بعد النشر: جرّب نفس الاختبارات على عنوان Netlify (تسجيل الدخول + استرجاع كلمة المرور).

---

## 4. (اختياري) أمان مفتاح Resend

- إن كان مفتاح Resend قد ظهر في محادثة أو ملف: أنشئ مفتاحاً جديداً من [resend.com](https://resend.com) → API Keys، واحذف القديم.
- حدّث الـ Secret في Supabase:
  ```powershell
  npx supabase secrets set RESEND_API_KEY=المفتاح_الجديد
  ```

---

## 5. (اختياري) جدول تتبع المشاكل

- إن ظهر خطأ **400 - getAllIssues**: تأكد من تطبيق ترحيل `issue_tracking`:
  ```powershell
  npx supabase db push
  ```
  (أو نفّذ محتوى `20260221120000_issue_tracking_table.sql` من SQL Editor في Supabase.)

---

**الخلاصة:** التأكد من وجود مستخدم → اختبار الدخول واسترجاع كلمة المرور محلياً → نشر الواجهة على Netlify → اختبار على النطاق المنشور.
